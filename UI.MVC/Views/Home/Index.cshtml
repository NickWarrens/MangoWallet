@using Domain.Currencies.BaseCurrency
@model Domain.Users.User

@{
    ViewData["Title"] = "Home";
    Layout = "_Layout";
}

<link rel="stylesheet" href="~/css/Index.css" />
<h1>Welcome back, @Model.Name</h1>

<h2>Wallet (@Model.UserWallet.WalletKey):</h2>
<div class="currency-cards">
    @foreach (var currency in Model.UserWallet.CurrencyBalances)
    {
        <div class="currency-card">
            <h2>@CurrencyMetaDataProvider.GetCurrencyName(currency.CurrencyType)</h2>
            <p><strong>Balance:</strong> @currency.Balance@CurrencyMetaDataProvider.GetCurrencySymbol(currency.CurrencyType)</p>
        </div>
    }
</div>

<div class="actions">
    <button class="btn btn-primary" id="exchange-btn">Exchange Currency</button>
    <button class="btn btn-primary" id="transfer-btn">Transfer Currency</button>

    @if (@Model.IsAdmin)
    {
        <form asp-action="ManageCurrency" asp-controller="Currency" method="get">
            <button type="submit" class="btn btn-secondary">Add/Subtract currency</button>
        </form>
    }
</div>

<!-- Exchange Currency Modal -->
<div class="modal" id="exchange-modal">
    <div class="modal-content">
        <span class="close" id="close-exchange">&times;</span>
        <h3>Exchange Currency</h3>
        <form method="post" action="@Url.Action("ExchangeCurrency", "Currency")">
            <div class="form-group">
                <label for="exchangeFrom">From Currency</label>
                <select id="exchangeFrom" name="fromCurrency" class="form-control" required>
                    @foreach (var currency in Enum.GetValues(typeof(CurrencyType)).Cast<CurrencyType>())
                    {
                        <option value="@currency">@CurrencyMetaDataProvider.GetCurrencyName(currency)</option>
                    }
                </select>
            </div>

            <div class="form-group">
                <label for="exchangeTo">To Currency</label>
                <select id="exchangeTo" name="toCurrency" class="form-control" required>
                    @foreach (var currency in Enum.GetValues(typeof(CurrencyType)).Cast<CurrencyType>())
                    {
                        <option value="@currency">@CurrencyMetaDataProvider.GetCurrencyName(currency)</option>
                    }
                }
                </select>
            </div>

            <div class="form-group">
                <label for="exchangeAmount">Amount</label>
                <input type="number" id="exchangeAmount" name="amount" class="form-control" min="0.01" step="0.01" required />
            </div>

            <button type="submit" class="btn btn-primary">Exchange</button>
        </form>
    </div>
</div>

<div class="modal" id="transfer-modal">
    <div class="modal-content">
        <span class="close" id="close-transfer">&times;</span>
        <h3>Transfer Currency</h3>
        <form method="post" action="@Url.Action("TransferCurrency", "Currency")">
            <div class="form-group">
                <label for="transferCurrency">Currency</label>
                <select id="transferCurrency" name="currency" class="form-control" required>
                    @foreach (var currency in Enum.GetValues(typeof(CurrencyType)).Cast<CurrencyType>())
                    {
                        <option value="@currency">@CurrencyMetaDataProvider.GetCurrencyName(currency)</option>
                    }
                </select>
            </div>

            <div class="form-group">
                <label for="walletKey">Wallet Key</label>
                <input type="text" id="walletKey" name="walletKey" class="form-control" required />
            </div>

            <div class="form-group">
                <label for="transferAmount">Amount</label>
                <input type="number" id="transferAmount" name="amount" class="form-control" min="0.01" step="0.01" required />
            </div>

            <button type="submit" class="btn btn-secondary">Transfer</button>
        </form>
    </div>
</div>

<script src="~/js/popus.js"></script>
